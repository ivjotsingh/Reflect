<!-- Breathing Exercise Modal -->
<div id="breathing-exercise-modal" class="modal-overlay">
    <div class="breathing-modal">
        <div class="modal-header">
            <h2>Guided Breathing Exercise</h2>
            <button id="close-breathing-modal" class="close-modal-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="modal-content">
            <!-- Technique Selection View -->
            <div id="breathing-selection" class="breathing-selection">
                <div class="breathing-description">
                    <p>Select a scientifically-proven breathing technique to begin your guided exercise. These
                        mindful practices can help reduce stress, anxiety, and promote a sense of calm and balance.
                    </p>
                </div>

                <h3>Choose Your Technique</h3>
                <div class="breathing-patterns">
                    <!-- 4-7-8 Breathing - Dr. Andrew Weil's technique -->
                    <div class="breathing-pattern-card" data-pattern="478">
                        <div class="technique-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24"
                                fill="none" stroke="#3498db" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                                <line x1="15" y1="9" x2="15.01" y2="9"></line>
                            </svg>
                        </div>
                        <h4>4-7-8 Technique</h4>
                        <p>Inhale (4s) → Hold (7s) → Exhale (8s)</p>
                        <span class="pattern-description">Developed by Dr. Andrew Weil - reduces anxiety, helps with
                            sleep, and lowers stress response</span>
                    </div>

                    <!-- Coherent Breathing - clinically proven -->
                    <div class="breathing-pattern-card" data-pattern="coherent">
                        <div class="technique-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24"
                                fill="none" stroke="#3498db" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z">
                                </path>
                                <path d="M8 12h8"></path>
                                <path d="M12 8v8"></path>
                            </svg>
                        </div>
                        <h4>Coherent Breathing</h4>
                        <p>Inhale (5.5s) → Exhale (5.5s)</p>
                        <span class="pattern-description">Researched at Harvard Medical School - balances autonomic
                            nervous system, creating psychophysiological coherence</span>
                    </div>

                    <!-- Diaphragmatic Breathing - physiological research backed -->
                    <div class="breathing-pattern-card" data-pattern="diaphragmatic">
                        <div class="technique-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24"
                                fill="none" stroke="#3498db" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z">
                                </path>
                                <path d="M7 10l5 5 5-5"></path>
                            </svg>
                        </div>
                        <h4>Diaphragmatic Breathing</h4>
                        <p>Deep Inhale (4s) → Hold (1s) → Slow Exhale (6s)</p>
                        <span class="pattern-description">Recommended by Mayo Clinic - activates parasympathetic
                            nervous system, reduces cortisol levels</span>
                    </div>
                </div>
            </div>

            <!-- Interactive Exercise View -->
            <div id="breathing-exercise-container" class="breathing-exercise-container">
                <div class="exercise-header">
                    <div>
                        <h3 class="exercise-title" id="technique-title">4-7-8 Breathing Technique</h3>
                        <p class="exercise-subtitle" id="technique-subtitle">Developed by Dr. Andrew Weil for stress
                            reduction</p>
                    </div>
                    <button class="back-to-selection">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Back to techniques
                    </button>
                </div>

                <div class="breathing-visualization">
                    <div class="breathing-circle-wrapper">
                        <div class="circle-border"></div>
                        <div class="breathing-circle">
                            <div class="wave-container">
                                <div class="wave"></div>
                            </div>
                            <div class="breathing-animation"></div>
                            <div class="breathing-animation-shadow"></div>
                        </div>

                        <div class="breathing-instruction">
                            <div class="breathing-action" id="breathing-action">Prepare...</div>
                            <div class="breathing-counter" id="breathing-counter">3</div>
                        </div>
                    </div>

                    <div class="breathing-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="progress-stats">
                            <span id="current-cycle">Cycle 0/5</span>
                            <span id="timer">00:00</span>
                        </div>
                    </div>

                    <div class="breathing-controls">
                        <button id="start-breathing" class="breathing-control-btn start">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                            </svg>
                            Begin Exercise
                        </button>
                        <button id="pause-breathing" class="breathing-control-btn pause" style="display: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect x="6" y="4" width="4" height="16"></rect>
                                <rect x="14" y="4" width="4" height="16"></rect>
                            </svg>
                            Pause
                        </button>
                        <button id="resume-breathing" class="breathing-control-btn resume" style="display: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                            </svg>
                            Resume
                        </button>
                        <button id="stop-breathing" class="breathing-control-btn stop" style="display: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            </svg>
                            End Early
                        </button>
                    </div>
                </div>
            </div>

            <!-- Completion View -->
            <div id="breathing-complete" class="breathing-complete">
                <div class="complete-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none"
                        stroke="#3498db" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                </div>
                <h3>Exercise Complete!</h3>
                <p>Well done! Regular breathing exercises can significantly reduce stress and anxiety levels. How
                    are you feeling now?</p>

                <div class="post-exercise-mood">
                    <button class="mood-btn" data-mood="calmer">Much Calmer</button>
                    <button class="mood-btn" data-mood="bit-better">A Bit Better</button>
                    <button class="mood-btn" data-mood="same">About the Same</button>
                    <button class="mood-btn primary" data-mood="again">Do Another Exercise</button>
                </div>
            </div>
        </div>
    </div>
</div>
